function addNewParticipant(t){$(".noitems").remove();var e=t.attr("data-prototype"),i=t.children().length,a=e.replace(/__name__/g,i).replace(/__participantcount__/g,i+1),n=$(a);t.append(n),n.show(300),bindDeleteButtonEvents(),$(".remove-participant").removeClass("disabled"),resetRanks()}function bindDeleteButtonEvents(){$("button.remove-participant").each(function(){$(this).off("click"),$(this).click(function(t){t.preventDefault(),$(this).parents("tr.wishlistitem").hasClass("new-row")&&($(this).parents("tr.wishlistitem").remove(),$(".add-new-participant").show());var e=$(".new-row .wishlistitem-description").val();"undefined"!=typeof e&&""==e&&($(".new-row").remove(),$(".add-new-participant").show()),1==$(".wishlistitem-description").length?$(".wishlistitem-description").val(""):$(this).parents("tr.wishlistitem").remove(),$(".ajax-response").children().hide(),$(".ajax-response .empty").hide(),$(".ajax-response .removed").show(),resetRanks(),ajaxSaveWishlist()})})}function resetRanks(){$("table.participants tbody tr").each(function(t){$(this).find('td input[type="hidden"]').val(t+1),$(this).find("td span.rank").text(t+1)})}function ajaxSaveWishlist(){var t=$(".new-row .wishlistitem-description").val();if("undefined"!=typeof t&&""==t)return $(".ajax-response .empty").show(),!1;$(".ajax-response .empty").hide();var e=$("#add_item_to_wishlist_form").serializeArray(),i=$("#add_item_to_wishlist_form").attr("action");$.ajax({type:"POST",url:i,data:e})}var collectionHolder=$("table.wishlist-items tbody");jQuery(document).ready(function(){$(".add-new-participant").click(function(t){t.preventDefault(),$(".add-new-participant").hide(),addNewParticipant(collectionHolder)}),$(".update-participant").click(function(t){t.preventDefault(),$(this).hide(),$(".ajax-response").children().hide(),$(".ajax-response .updated").show(),ajaxSaveWishlist()}),$("#add_item_to_wishlist_form").submit(function(t){t.preventDefault();var e=$(this).find("button[type=submit]");e.hide(),$(".add-new-participant").hide(),$(".ajax-response").children().hide(),$(".ajax-response .added").show(),$("tr.wishlistitem").removeClass("new-row"),ajaxSaveWishlist(),addNewParticipant(collectionHolder)}),$(".wishlistitem").on("keydown",".wishlistitem-description",function(){$(this).closest(".wishlistitem").find("button.update-participant").show()}),bindDeleteButtonEvents(),$(".remove-participant").removeClass("disabled"),$("table.participants tbody").sortable({stop:function(){resetRanks(),ajaxSaveWishlist()}}),$("table.participants tbody").bind("click.sortable mousedown.sortable",function(t){t.target.focus()})});
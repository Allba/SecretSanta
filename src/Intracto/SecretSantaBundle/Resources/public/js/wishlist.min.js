function addNewEntry(e){$(".noitems").remove();var t=e.attr("data-prototype"),n=e.children().length,i=t.replace(/__name__/g,n).replace(/__entrycount__/g,n+1),s=$(i);e.append(s),s.show(300),bindDeleteButtonEvents(),$(".remove-entry").removeClass("disabled"),resetRanks()}function bindDeleteButtonEvents(){$("button.remove-entry").each(function(){$(this).off("click"),$(this).click(function(e){e.preventDefault(),$(this).parents("tr.wishlistitem").hasClass("new-row")&&($(this).parents("tr.wishlistitem").remove(),$(".add-new-entry").show());var t=$(".new-row .wishlistitem-description").val();return"undefined"!=typeof t&&""==t?($(".ajax-response .empty").show(),!1):($(".ajax-response").children().hide(),$(".ajax-response .empty").hide(),$(".ajax-response .removed").show(),$(this).parents("tr.wishlistitem").remove(),resetRanks(),ajaxSaveWishlist(),void 0)})})}function resetRanks(){$("table.entries tbody tr").each(function(e){$(this).find('td input[type="hidden"]').val(e+1),$(this).find("td span.rank").text(e+1)})}function ajaxSaveWishlist(){var e=$(".new-row .wishlistitem-description").val();if("undefined"!=typeof e&&""==e)return $(".ajax-response .empty").show(),!1;$(".ajax-response .empty").hide();var t=$("#add_item_to_wishlist_form").serializeArray();$.ajax({type:"POST",data:t},function(e){200==e.responseCode&&console.log("Succes!")})}var collectionHolder=$("table.entries tbody");jQuery(document).ready(function(){$(".add-new-entry").click(function(e){e.preventDefault(),$(".add-new-entry").hide(),addNewEntry(collectionHolder)}),$(".update-entry").click(function(e){e.preventDefault(),$(this).hide(),$(".ajax-response").children().hide(),$(".ajax-response .updated").show(),ajaxSaveWishlist()}),$("#add_item_to_wishlist_form").submit(function(e){e.preventDefault();var t=$(this).find("button[type=submit]");t.hide(),$(".add-new-entry").hide(),$(".ajax-response").children().hide(),$(".ajax-response .added").show(),$("tr.wishlistitem").removeClass("new-row"),ajaxSaveWishlist(),addNewEntry(collectionHolder)}),$(".wishlistitem").on("keydown",".wishlistitem-description",function(){$(this).closest(".wishlistitem").find("button.update-entry").show()}),bindDeleteButtonEvents(),$(".remove-entry").removeClass("disabled"),$("table.entries tbody").sortable({stop:function(){resetRanks(),ajaxSaveWishlist()}}),$("table.entries tbody").bind("click.sortable mousedown.sortable",function(e){e.target.focus()})});
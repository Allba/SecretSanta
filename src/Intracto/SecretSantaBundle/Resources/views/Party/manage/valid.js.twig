<script type="text/javascript">
    $(document).ready(function () {
        $('#btn_delete').click(function (e) {
            $('#delete-warning').show();
            $('#btn_delete').attr('disabled', true);
            $('#delete-confirmation').focus();
        });
        $('#btn_delete_cancel').click(function (e) {
            $('#delete-warning').hide();
            $('#btn_delete').attr('disabled', false).focus();
        });

        $('#btn_add').click(function (e) {
            $('#add-participant').show();
            $('#btn_add').attr('disabled', true);
            $('#add-participant-name').focus();
        });

        $('#btn_add_cancel').click(function (e) {
            $('#add-participant').hide();
            $('#btn_add').attr('disabled', false).focus();
        });

        $('#btn_update').click(function (e) {
            $('#update-party-details').show();
            $('#btn_update').attr('disabled', true);
        });

        $('#btn_update_cancel').click(function (e) {
            $('#update-party-details').hide();
            $('#btn_update').attr('disabled', false).focus();
        });

        $('.link_remove_participant').click(function(e) {
            $('#delete-participant').show();
            $('.link_remove_participant').attr('disabled', true);
            $('#delete-participant-confirmation').focus();
            var listUrl = '{{ party.listUrl }}';
            var entryId = $(this).data('entry');
            attachAction(listUrl, entryId);
        });

        $('.btn_remove_participant_cancel').click(function (e) {
            $('#delete-participant').hide();
            $('.link_remove_participant').attr('disabled', false);
        });

        if (Modernizr.inputtypes.date == true) {
            $("#intracto_secretsantabundle_updatepooldetailstype_eventdate").click(function (e) {
                $(this).datepicker({dateFormat: 'dd-mm-yy'});
            });
        }
    });

    function editParticipant(listUrl, entryId) {
        var email = $('#email_' + entryId).html();
        var name = $('#name_' + entryId).html();
        var url = '{{ path("participant_edit", { 'listUrl': 'listUrl', 'participantId': 'entryId' }) }}';
        url = url.replace("listUrl", listUrl);
        url = url.replace("entryId", entryId);
        if ($('#email_' + entryId).has('form').length == 0) {
            $('#name_' + entryId).html(
                '<input type="text" id="input_name_' + entryId + '" class="form-control input_edit_email" name="name" value="' + name + '" data-hj-masked>'
            );
            $('#email_' + entryId).html(
                '<form id ="form_' + entryId + '" action="' + url + '" method="post">' +
                '<input type="text" id="input_email_' + entryId + '" class="form-control input_edit_email" name="email" value="' + email + '" data-hj-masked>&nbsp;' +
                '<button class="btn btn-small btn-primary" onclick="submitEditForm(' + entryId + ')"><i class="fa fa-check"></i> {{ 'pool_manage_valid.manage.save'|trans }}</button>'+
                '</form>'
            );
        }
    }

    function submitEditForm(entryId) {
            $('#form_' + entryId).append($('#input_name_' + entryId));
            $('#form_' + entryId).hide();
            $('#name_' + entryId).html('<i class="fa fa-spinner fa-spin "></i>');
            $(document.body).append($('#form_' + entryId));
            $('#form_' + entryId).submit();
    }

    function attachAction(listUrl, entryId) {
        var url = '{{ path('participant_remove', {'listUrl': 'listUrl', 'participantId': 'entryId'}) }}';
        url = url.replace('listUrl', listUrl);
        url = url.replace('entryId', entryId);
        $('#delete-participant-form').attr('action', url);
    }
</script>
